{"componentChunkName":"component---src-templates-blog-template-js","path":"/blog/eos-zswap-zstd-z3fold","result":{"data":{"markdownRemark":{"html":"<h2>Minimum Requirements</h2>\n<ul>\n<li>Fast Cpu with 3 cores or more.</li>\n<li>Low Ram - 4gb or less</li>\n</ul>\n<h2>ZSWAP</h2>\n<p>zswap is a Linux kernel feature that provides a compressed write-back cache for swapped pages, as a form of virtual memory compression. Instead of moving memory pages to a swap device when they are to be swapped out, zswap performs their compression and then stores them into a memory pool dynamically allocated in the system RAM. Later, writeback to the actual swap device is deferred or even completely avoided, resulting in a significantly reduced I/O for Linux systems that require swapping; the tradeoff is the need for additional CPU cycles to perform the compression.</p>\n<p>ZSWAP allows linux to make more efficient use of RAM as it virtually increase memory capacity, rather than slightly increased CPU usage to compress / unzip the swap pages.</p>\n<p>ZSWAP is present in the kernel but is never used, and to use it you must explicitly enable through <code class=\"language-text\">GRUB_CMDLINE_LINUX_DEFAULT</code> at <code class=\"language-text\">/etc/default/grub</code> file.</p>\n<h2>Zstandard (zstd)</h2>\n<p>Zstandard is a real-time compression algorithm, providing high compression ratios. It offers a very wide range of compression / speed trade-off, while being backed by a very fast decoder (see benchmarks below). It also offers a special mode for small data, called dictionary compression, and can create dictionaries from any sample set. Zstandard library is provided as open source software using a BSD license.std stands for ZStandard develop by facebook.</p>\n<p><a href=\"http://www.zstd.net/\">http://zstd.net</a></p>\n<h3>Steps to enable ZSWAP</h3>\n<ol>\n<li>Edit grub as root</li>\n</ol>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-shell line-numbers\"><code class=\"language-shell\">$ <span class=\"token function\">sudo</span> <span class=\"token function\">nano</span> /etc/default/grub</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span></span></pre></div>\n<ol start=\"2\">\n<li>Edit <code class=\"language-text\">GRUB_CMDLINE_LINUX_DEFAULT=\"quiet splash\"</code></li>\n</ol>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-shell line-numbers\"><code class=\"language-shell\"><span class=\"token assign-left variable\">GRUB_CMDLINE_LINUX_DEFAULT</span><span class=\"token operator\">=</span><span class=\"token string\">\"quiet splash zswap.enabled=1 zswap.compressor=zstd zswap.zpool=z3fold\"</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span></span></pre></div>\n<ol start=\"3\">\n<li>Update grub</li>\n</ol>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-shell line-numbers\"><code class=\"language-shell\">$ <span class=\"token function\">sudo</span> <span class=\"token function\">update-grub</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span></span></pre></div>\n<h3>Steps to install zstd and Z3fold</h3>\n<ol>\n<li>Install checkinstall and build-essential</li>\n</ol>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-shell line-numbers\"><code class=\"language-shell\">$ <span class=\"token function\">sudo</span> <span class=\"token function\">apt</span> <span class=\"token function\">install</span> checkinstall build-essential</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span></span></pre></div>\n<ol start=\"2\">\n<li>You can install zstd from <code class=\"language-text\">sudo apt install zstd</code> but its not the latest version. To install the latest version follow the steps below.</li>\n</ol>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-shell line-numbers\"><code class=\"language-shell\">$ <span class=\"token function\">sudo</span> -s\n$ <span class=\"token builtin class-name\">cd</span> /tmp\n$ <span class=\"token function\">wget</span> https://github.com/facebook/zstd/releases/download/v1.4.3/zstd-1.4.3.tar.gz -O zstd.tar.gz\n$ <span class=\"token function\">tar</span> -xf zstd.tar.gz\n$ <span class=\"token builtin class-name\">cd</span> zstd-1.4.3\n$ <span class=\"token function\">make</span>\n$ <span class=\"token builtin class-name\">echo</span> y <span class=\"token operator\">|</span> checkinstall</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<ol start=\"3\">\n<li>Edit file <code class=\"language-text\">/etc/initramfs-tools/modules</code>.</li>\n</ol>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-shell line-numbers\"><code class=\"language-shell\">$ <span class=\"token function\">sudo</span> <span class=\"token function\">nano</span> /etc/initramfs-tools/modules</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span></span></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-text line-numbers\"><code class=\"language-text\"># List of modules that you want to include in your initramfs.\n# They will be loaded at boot time in the order below.\n#\n# Syntax:  module_name [args ...]\n#\n# You must run update-initramfs(8) to effect this change.\n#\n# Examples:\n#\n# raid1\n# sd_mod\nzstd\nzstd_compress\nz3fold</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-shell line-numbers\"><code class=\"language-shell\">$ <span class=\"token function\">sudo</span> update-initramfs -u -k all</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span></span></pre></div>\n<ol start=\"5\">\n<li>Restart PC and verify ZSWAP if enabled</li>\n</ol>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-shell line-numbers\"><code class=\"language-shell\">$ <span class=\"token function\">cat</span> /sys/module/zswap/parameters/enabled\n$ Y</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span></span></pre></div>\n<p>Response should show <code class=\"language-text\">Y</code>.</p>\n<ol start=\"6\">\n<li>Verify ZSWAP if its using zstd and z3fold</li>\n</ol>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-shell line-numbers\"><code class=\"language-shell\">$ <span class=\"token function\">sudo</span> <span class=\"token function\">dmesg</span> <span class=\"token operator\">|</span> <span class=\"token function\">grep</span> -i zswap:\n<span class=\"token punctuation\">[</span>    <span class=\"token number\">1.059997</span><span class=\"token punctuation\">]</span> zswap: loaded using pool zstd/z3fold</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span></span></pre></div>","frontmatter":{"date":"October 05, 2019","path":"/blog/eos-zswap-zstd-z3fold","title":"Improving Elementary Os Performance using ZSWAP, zstd and z3fold","tags":["elementary-os","zswap","zstd","z3fold"]}}},"pageContext":{}},"staticQueryHashes":["3649515864","63159454"]}